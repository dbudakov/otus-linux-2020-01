[logo1]: https://github.com/dbudakov/22.route/blob/master/image/OSPF_steps/1.png
[logo2]: https://github.com/dbudakov/22.route/blob/master/image/OSPF_steps/2.png
[logo3]: https://github.com/dbudakov/22.route/blob/master/image/OSPF_steps/3.png
[logo4]: https://github.com/dbudakov/22.route/blob/master/image/OSPF_steps/4.png
[logo5]: https://github.com/dbudakov/22.route/blob/master/image/OSPF_steps/5.png
[logo6]: https://github.com/dbudakov/22.route/blob/master/image/OSPF_steps/6.png
[logo7]: https://github.com/dbudakov/22.route/blob/master/image/OSPF_steps/7.png
[logo8]: https://github.com/dbudakov/22.route/blob/master/image/OSPF_steps/8.png


### Алгоритм установления смежности и затем соседства   
#### 1. Обмен HELLO-пакетами   
   На схеме два роутера в состоянии DOWN. Значения Hello/Routerdead interval у них одинаковы, линки у них в одной зоне, их типы сетей также одинаковые(broadcast), Router ID у них разные(они должны быть разными) ![logo1]  

#### 2. Формируется таблица состояний связей с соседями (link-state)   
   Один из роутеров переходит в состояние INIT и рассылает HELLO-пакет,в HELLO-пакете он пишет свой RouterID, Hello interval, Dead interval, кол-во соседей ![logo2]

#### 3.  Формируют LSA - (router id, neighbor id, net/mask, net type, cost)
HELLO-пакет получает роутер R2, сравнивает показатели, видит что соседей 0, видит несоответствие так как получил пакет в пределах одного канала ![logo3]

#### 4.Маршрутизатор рассылает LSA своим соседям, те распространяют LSA дальше.  
R2 отвечает на HELLO-пакет сообщая что R1 является его соседом, в этот момент роутеры переходят в состояние EXSTART, TWO-WAY, то есть HELLO-пакеты были отправлены и получены и начался обмен информацией ![logo4]

#### 5 Каждый маршрутизатор, получивший LSA добавляет его в свою локальную табличку LSDB(Link State Database) 
Обмен информацией на статусе TWO-WAY представляет из себя пересылку DBD-пакета который содержит информацию о том какие сети сейчас подключены к R2 ![logo5]

#### 6. В LSDB скапливаетcя информация, обо всех парах соединённых в сети маршрутизаторов.
Маршрутизаторы добавляют в свою табличку информацию о сетях, отправляют соседнему маршрутизатору, соседний в свою очередь подтверждает что получил его информацию, и накидывает сверху информацию о своих подключениях ![logo6]

#### 7. После обмена LSA, каждый маршрутизатор знает про все линки, на основании пар строится полная карта сети.
R2 подтверждает получение информации о подключениях R1 ![logo7]

#### 8. На основании этой карты каждый маршрутизатор индивидуально ищет кратчайшие с точки зрения метрики маршруты во все сети и добавляет из в таблицу маршрутизации.
В итоге все пять сетей стали известны и R1 и R2, и как только этот обмен картами сетей завершился они перешли в состояние FULL STATE, после этого каждый из них начинает анализировать свои LSDB и строить таблицу маршрутизации. В случае изменении в сети, будет вновь рассылаться LSU, в следствии актуализироваться список LSDB и маршрутов ![logo8]


