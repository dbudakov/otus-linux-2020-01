VLAN
  https://ru.wikipedia.org/wiki/VLAN
  Virtual Local Area Network - топологическая(виртуальная) локальная компьютерная сеть, представляет собой группу хостов с общим набором требований, которые взаимодействуют так, как если бы они были подключены к широковещательному домену, независимо от их физического местонахождения.
  Механимз для создания логической топологии сети, не зависящей от ее физической топологии

Необходимость применения VLAN:
  - изоляция сегментов сети
  - гибкое разделение хостов на группы
  - сокращение широковещательного трафика
  - увеличение безопасности и управляемости сети

Особенности
  - не требуется физическое перемещение устройств
  - требуется использование коммутаторов с поддержкой VLAN
  - используется процедуры тэгирования трафика
  - тэги инкапсулируются в ethernet кдра
  - поле для Vlan IP (VID) в тэге - всего 12 бит
  - после добавлиния тэга пересчитывается контрольная сумма кадра
  - максимальное количество VID - 4096,  а точнее 4094, так как VID 0 и 4095 зарезервированы и не используются

IEEE 802.1Q - открытый стандарт, который описывает процедуру тегирования трафика для передачи информации о принадлежности к VLAN по сетям стандарта IEEE 802.3 Ethernet
  https://ru.wikipedia.org/wiki/IEEE_802.1Q


Принцип работы:
  1. Заголовок 802.1q размером 32 бита добавляется внутрь заголовка еthernet  фрейма и увеличиввает р-р фрейма на 4 октета(32 бита)

  2. При посылке через vlan-интерфейс и передаче в родительский интерфейс к фрейму добавляется 802.1q заголовок и контрольная сумма фрейма пересчитывается

  3. При приеме фрейма на интерфейс система смотрит наличие у него 802.1q заголовка и, если нет, отправляет его на физический интерфейс(native vlan), а если есть - в соответствующий vlan-интерфейс

Настройка с помощью vconfig
  Установка
    yum install vconfig

  Добавляем VLAN5 на интерфейс eth0
    vconfig add eth0 5

  Добавляем адрес на vlan-интерфейс
    ip add add 10.10.30.1/30 dev eth0.5

  Поднимаем интерфейс
    ip link set up dev bond0.5
    ifconfig eth0.5 up

Настройка с помощью network-scripts
  ## /etc/sysconfig/network-scripts/ifcfg-vlan10
  ONBOOT=yes
  TYPE=Ethernet
  VLAN=yes
  VLAN_NAME_TYPE=DEV_PLES_VID_NO_PAD # некая  маска для назначения имени
  DEVICE=vlan10
  PHYSDEV=eth0
  VLAN_ID=10
  BOOTPROTO=static
  IPADDR=192.168.0.15
  NETMASK=255.255.255.0
  NM_CONTROLLED=no

Настройка с помощью NetworkManager
  Добавляем vlan-интерфейс с именем eth0.12 и VID 12
    nmcli con add type vlan con-name eth0.12 dev eth0 id 12
    or
    nmcli con add type vlan ifname VLAN10 dev enp1s0 id 10

  То же самое, но добавляется ip адрес на vlan-интерфейс
    nmcli con add type vlan con-name VLAN20 dev enp1s0 id 20 ip4 10.10.10.5/24 [gw4 8.8.8.8]

  Смотрим сущесвующие интерфейсы
    nmcli connection
    nmcli device


Дополнительно:
маршрутизация в vlan'х VRF
Access ports
trunk ports
trunk native port
