DNS replication
В протокол DNS встроена возможность репликации зон. Это происходит с помощью апросов
  - AXFR (transfer all records)
  - IXFR (incremental transfer)
Для репликации DNS использует протокол tcp, т.к. важна гарантия доставки

Репликация происходит только при одном условии - local-serial < remote_serial. Проверка serial является частью процесса репликации.
Репликация может быть инициирована следующими событиями:
  - ручной запуск(reload)
  - истечение timeout указанного в SOA
  - NOTIFY-запрос

На рисунке мы видим что slave-сервер запросил SOA запись, master-сервер отдал ему SOA. Спустя какое-то приходит время сверки SOA и slave-сервер видит что значение serial имеющегося файла, меньше чем значение серийника на мастере, соответственно он делает AXFR и master пересылает ему новую зону.


для настройки репликации необходимо править конфиг bind'a
## /etc/named.conf

Безопасность.
  TSIG (transaction signatures)
  Генерация секрета:
    dnssec-keygen -a HMAC-MD5 -b 128 -n HOST имя-ключа
  ключ обновляется и распостроняется вручную, как вариант в описании зоны есть строка, для того чтобы подтянуть ключ
    include "/etc/named.zonetransfer.key";
    server 192.168.50.11 {
        keys { "zonetransfer.key"; };
    };
  настроив auditd к соответствующему файлу, можно следить за файлом

  При настройке DNS сервера нужно иметь ввиду
    - доступ к DNS-серверу должны иметь только те, кому надо отвечать на запросы. При настройке локальной сети с помощью acl ограничиваются ip-адреса с которых возможны dns-запросы. 53 порт открывается только во внутрь.
    - при создании публичного сервера, ограничиваются рекурсивные запросы, для лишних(не целевых) сегментов(зон), чтобы не брать работу которую делать не надо.
    - ограничивается список тех хостов с которых может прилетать NOTIFY, для перезагрузки зон,
    - ограничивпется список тех хостов, с которых может стягиваться зона, как мастера, так и slave'ов, то есть список для master-сервера тоже нужен, для того чтобы slav'ы не стянули левый SOA. А также нельзя отдавать(на копию) зону, всем клиентам, так как сервер можно положить постоянно запуская операцию копирования зоны. Обычно master-сервер не светят и публикуют доступ только slave'ов.
  Можно сделать заключение, что слово "any" в конфигах, должно встречаться  в очень ограниченном кол-ве случаев, когда Вы четко понимаете, что делаете.

Внешние name-сервера прописывают либо сами, либо в файле зоны, указан файлик "named.ca"  в разделе "view", корневые серверы у нас в принципе идут в поставке, они всегда известны по выводу из файла /var/names/named.ca

DDoS -
  DNS-Authentificantion - посылается на сервер такой пакет в котором говорится отдать всю зону, но не мне а кому-то другому, указазывая в ip-src другой сервер, в итоге гдето по дороге, забивается какой-либо канал и сервис становится недоступен.

Там где нет возможности ставить свой NS, например небольшие компании, ставят DNS провайда,также можно использовать google cloudflare(1.1.1.1,8.8.8.8)
